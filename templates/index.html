{% extends "base.html" %}
{% block content %}
<h2 class="text-xl font-bold mb-4">ðŸ“Š Messsystem-Konfiguration</h2>

<div id="messageBox" class="hidden mb-4"></div>

<form id="configForm" onsubmit="saveConfig(event)" class="bg-white p-4 sm:p-6 rounded-xl shadow">
  {% for key, val in config.items() %}
  <div class="mb-4">
    <label class="block font-semibold text-gray-700 mb-1">{{ key }}</label>
    <input name="{{ key }}" value="{{ val }}" class="border p-2 w-full rounded focus:ring-2 focus:ring-blue-400 outline-none" />
    <p class="text-gray-500 text-sm mt-1">{{ descriptions.get(key) }}</p>
  </div>
  {% endfor %}
  <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 w-full sm:w-auto">ðŸ’¾ Speichern</button>
</form>

<script>
async function saveConfig(event) {
  event.preventDefault();
  const form = document.getElementById('configForm');
  const formData = new FormData(form);
  const response = await fetch('{{ url_for("update_config") }}', { method: 'POST', body: formData });
  const result = await response.json();

  const box = document.getElementById("messageBox");
  box.classList.remove("hidden");
  box.textContent = result.message;
  box.className = result.success
    ? "p-3 rounded bg-green-200 text-green-800 mb-4"
    : "p-3 rounded bg-red-200 text-red-800 mb-4";
}
</script>
{% endblock %}